@using Atlas.Core.Dynamic
@using Microsoft.AspNetCore.Components.Forms

@* @attribute [StreamRendering] *@
@typeparam T where T : class, new()
@inherits GenericModelsViewBase<T>

@if (!Loaded)
{
    <Loading Title="@PageArgs?.DisplayName" Message="Loading..." />
}
else
{
    <FluentLabel Color="Color.Accent" Typo="Typography.PageTitle">@PageArgs?.DisplayName</FluentLabel>

    <FluentDataGrid Id="genericModelsSource" Items="@Source" Virtualize="true" ItemSize="46" GenerateHeader="GenerateHeaderOption.Sticky" TGridItem=@T>

        @foreach (string field in Fields)
        {
            <PropertyColumn Title="@field" Property="@(f => DynamicType.GetValue(f, field))" Sortable="true" Align=Align.Start />
        }

        <TemplateColumn Title="Edit" Align="@Align.End">
            <FluentButton IconEnd="@(new Icons.Regular.Size16.Edit())" OnClick="@(() => RowButtonClick(context))" />
        </TemplateColumn>

    </FluentDataGrid>
}